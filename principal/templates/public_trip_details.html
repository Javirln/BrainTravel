{% extends 'base.html' %}
{% block title %} Search {% endblock %}
{% block content %}
<div class="row">
    <div class="col-xs-12">
        <h1>{{trip.name}}</h1>
    </div>
</div>
<div class="row">
    <div class="col-lg-9 animated fadeInUp">
        <div class="media well">
            <div class="row">
                <div class="col-xs-12 col-md-2 col-sm-2 col-lg-2 text-center">
                    <div>
                        <img class="avatar img-circle img-thumbnail" src="/static/user_folder/{{trip.traveller.photo}}" width="64" alt="Generic placeholder image">
                        <strong>
                        <br>
                            <a href="user.html">{{trip.traveller}}</a></strong><br>
                        <i class="fa fa-star"></i> {{ trip.traveller.reputation }} / 10<br>
                    </div>
                </div>
                <div class="col-xs-12 col-sm-10 col-lg-10 col-md-10">
                    <div class="media-body">
                        <blockquote>{{trip.publishedDescription|safe}}</blockquote>
                        {% if traveller_edit %}
                            <a href="/trip_edit/{{trip.scorable_ptr_id}}"><i class="fa fa-info-circle"></i> Edit</a>
                        {% endif %}

                    </div>
                </div>
        </div>
    </div>

    <div class="timeline-centered">
        <article class="timeline-entry entry">
            <div class="timeline-entry-inner">
                <div class="timeline-icon" style="-webkit-transform: rotate(-90deg); -moz-transform: rotate(-90deg);">
                    <i class="entypo-flight" style="text-decoration: None"></i> +
                </div>
                <div class="timeline-label">
                    <form class="form">
                        <div class="form-group">
                            <textarea class="form-control input-block-level" rows="3" style="resize: none;"></textarea>
                        </div>
                        <div class="form-group text-right">
                            <button type="submit" class="btn btn-success">Send</button>
                        </div>
                    </form>
                </div>
            </div>
        </article>
        {% for comment in comments %}
            {% if comments.last %}
                <article class="timeline-entry begin">
                    <div class="timeline-entry-inner">
                        <div class="timeline-icon">
                            <img class="img-circle" style="width: 40px; height: 40px;" src="/static/user_folder/{{ comment.traveller.photo }}">
                        </div>
                        <div class="timeline-label">
                            <h2><a href="#">{{comment.traveller}} says:</a></h2>
                            <br>
                            <i class="fa fa-quote-left fa-1x pull-left"></i>
                            {{comment.description|safe}}
                        </div>
                    </div>
                </article>
            {% else %}
            <article class="timeline-entry">
                <div class="timeline-entry-inner">
                    <div class="timeline-icon bg-success">
                        <i class="entypo-suitcase"></i>
                        <img class="img-circle" style="width: 40px; height: 40px;" src="/static/user_folder/{{ comment.traveller.photo }}">
                    </div>
                    <div class="timeline-label">
                        <h2><a href="#">{{comment.traveller}} says:</a></h2>
                        <br>
                        <i class="fa fa-quote-left fa-1x pull-left"></i>
                        {{comment.description|safe}}
                    </div>
                </div>
            </article>
            {% endif %}
        {% endfor %}
        </div>
    </div>
    <div class="col-lg-3">
        <div class="row">
            <div class="well">
                <i class="fa fa-globe fa-2x"> Seville, Spain</i>
                <br>
                <br>
                <i class="fa fa-calendar fa-2x"> {{ trip.startDate }}</i>
                <br>
                <br>
                <i class="fa fa-calendar-o fa-2x"> {{ trip.endDate }}</i>
            </div>
            <div class="well">
                <i class="fa fa-star fa-2x text-left"> <small>{% firstof trip.rating '-' %}</small> / <strong>10</strong></i>
                <br>
                <br>
                {% if user.is_anonymous %}
                    <i class="fa fa-thumbs-o-up fa-2x text-left"> {{trip.likes}} likes</i>
                    <br>
                    <br>
                    <i class="fa fa-thumbs-o-down fa-2x text-right"> {{trip.dislikes}} dislikes</i>
                {% endif %}

                {% if user.is_authenticated %}
                    {% if judge == None %}
                        <a href="/judge/{{trip.scorable_ptr_id}}/1">
                            <i class="fa fa-thumbs-o-up fa-2x text-left"> {{trip.likes}} likes</i>
                        </a>
                        <br>
                        <br>
                        <a href="/judge/{{trip.scorable_ptr_id}}/0">
                            <i class="fa fa-thumbs-o-down fa-2x text-right"> {{trip.dislikes}} dislikes</i>
                        </a>
                    {% elif judge.like == True %}
                        <a href="/judge/{{trip.scorable_ptr_id}}/1">
                            <i class="fa fa-thumbs-up fa-2x text-left"> {{trip.likes}} likes</i>
                        </a>
                        <br>
                        <br>
                        <a href="/judge/{{trip.scorable_ptr_id}}/0">
                            <i class="fa fa-thumbs-o-down fa-2x text-right"> {{trip.dislikes}} dislikes</i>
                        </a>
                    {% else %}
                        <a href="/judge/{{trip.scorable_ptr_id}}/1">
                            <i class="fa fa-thumbs-o-up fa-2x text-left"> {{trip.likes}} likes</i>
                        </a>
                        <br>
                        <br>
                        <a href="/judge/{{trip.scorable_ptr_id}}/0">
                            <i class="fa fa-thumbs-down fa-2x text-right"> {{trip.dislikes}} dislikes</i>
                        </a>
                    {% endif %}
                {% endif %}

                </div>
            <div class="well">
                <form id="stateSelectForm" class="form-horizontal" action="/administrator/trip/update/" method="post">
                    {% csrf_token %}
                    <input type="hidden" name="id" value="{{trip.scorable_ptr_id}}"/>
                    <div class="col-xs-5 selectContainer">
                        <select name="state" id="state" class="form-control">
                            {% if trip.state == "ap" %}
                                <option value="ap" selected="selected">APPROVED</option>
                            {% else %}
                                <option value="ap" >APPROVED</option>
                            {% endif %}

                             {% if trip.state == "re" %}
                                <option value="re" selected="selected">REJECTED</option>
                            {% else %}
                                <option value="re" >REJECTED</option>
                            {% endif %}

                            {% if trip.state == "pe" %}
                                <option value="pe" selected="selected">PENDING</option>
                            {% else %}
                                <option value="pe" >PENDING</option>
                            {% endif %}
                        </select>
                    </div>
                    <input type="submit" name="save" value="save" />
                </form>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript">
    $(document).ready(function() {
        $("#stateSelectForm").submit(function () {
            return confirm('Are you sure?');
        });
    });
</script>
{% endblock %}